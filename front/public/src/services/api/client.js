var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") return Reflect.decorate(decorators, target, key, desc);
    switch (arguments.length) {
        case 2: return decorators.reduceRight(function(o, d) { return (d && d(o)) || o; }, target);
        case 3: return decorators.reduceRight(function(o, d) { return (d && d(target, key)), void 0; }, void 0);
        case 4: return decorators.reduceRight(function(o, d) { return (d && d(target, key, o)) || o; }, desc);
    }
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var angular2_1 = require('angular2/angular2');
var cookie_1 = require('src/services/cookie');
var Client = (function () {
    function Client(http) {
        this.http = http;
        this.base = "/";
        this.cookie = new cookie_1.Cookie();
    }
    Client.prototype.buildParams = function (object) {
        return Object.keys(object).map(function (k) {
            return encodeURIComponent(k) + "=" + encodeURIComponent(object[k]);
        }).join('&');
    };
    Client.prototype.buildOptions = function (options) {
        var XSRF_TOKEN = this.cookie.get('XSRF-TOKEN');
        var headers = new angular2_1.Headers();
        headers.append('X-XSRF-TOKEN', XSRF_TOKEN);
        return Object.assign(options, {
            headers: headers,
            cache: true
        });
    };
    Client.prototype.get = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        endpoint += "?" + this.buildParams(data);
        return new Promise(function (resolve, reject) {
            self.http.get(self.base + endpoint, _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                return resolve(data);
            });
        });
    };
    Client.prototype.post = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.post(self.base + endpoint, JSON.stringify(data), _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                return resolve(data);
            });
        });
    };
    Client.prototype.put = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.put(self.base + endpoint, JSON.stringify(data), _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                return resolve(data);
            });
        });
    };
    Client.prototype.delete = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.delete(self.base + endpoint, _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                return resolve(data);
            });
        });
    };
    Client = __decorate([
        __param(0, angular2_1.Inject(angular2_1.Http)), 
        __metadata('design:paramtypes', [angular2_1.Http])
    ], Client);
    return Client;
})();
exports.Client = Client;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9zZXJ2aWNlcy9hcGkvY2xpZW50LnRzIl0sIm5hbWVzIjpbIkNsaWVudCIsIkNsaWVudC5jb25zdHJ1Y3RvciIsIkNsaWVudC5idWlsZFBhcmFtcyIsIkNsaWVudC5idWlsZE9wdGlvbnMiLCJDbGllbnQuZ2V0IiwiQ2xpZW50LnBvc3QiLCJDbGllbnQucHV0IiwiQ2xpZW50LmRlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSx5QkFBb0QsbUJBQW1CLENBQUMsQ0FBQTtBQUN4RSx1QkFBcUIscUJBQXFCLENBQUMsQ0FBQTtBQUszQztJQUdDQSxnQkFBaUNBLElBQVdBO1FBQVhDLFNBQUlBLEdBQUpBLElBQUlBLENBQU9BO1FBRjVDQSxTQUFJQSxHQUFZQSxHQUFHQSxDQUFDQTtRQUNwQkEsV0FBTUEsR0FBWUEsSUFBSUEsZUFBTUEsRUFBRUEsQ0FBQ0E7SUFDZ0JBLENBQUNBO0lBRXhDRCw0QkFBV0EsR0FBbkJBLFVBQW9CQSxNQUFlQTtRQUNsQ0UsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsVUFBQ0EsQ0FBQ0E7WUFDaENBLE1BQU1BLENBQUNBLGtCQUFrQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0Esa0JBQWtCQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNwRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDZEEsQ0FBQ0E7SUFLT0YsNkJBQVlBLEdBQXBCQSxVQUFxQkEsT0FBZ0JBO1FBQ3BDRyxJQUFJQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQTtRQUMvQ0EsSUFBSUEsT0FBT0EsR0FBR0EsSUFBSUEsa0JBQU9BLEVBQUVBLENBQUNBO1FBQzVCQSxPQUFPQSxDQUFDQSxNQUFNQSxDQUFDQSxjQUFjQSxFQUFFQSxVQUFVQSxDQUFDQSxDQUFDQTtRQUMzQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsT0FBT0EsRUFBRUE7WUFDM0JBLE9BQU9BLEVBQUVBLE9BQU9BO1lBQ2hCQSxLQUFLQSxFQUFFQSxJQUFJQTtTQUNYQSxDQUFDQSxDQUFDQTtJQUNOQSxDQUFDQTtJQUtESCxvQkFBR0EsR0FBSEEsVUFBSUEsUUFBaUJBLEVBQUVBLElBQWtCQSxFQUFFQSxPQUFvQkE7UUFBL0RJLGlCQWlCQ0E7UUFqQnNCQSxvQkFBa0JBLEdBQWxCQSxTQUFrQkE7UUFBRUEsdUJBQW9CQSxHQUFwQkEsWUFBb0JBO1FBQzlEQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUNoQkEsUUFBUUEsSUFBSUEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDekNBLE1BQU1BLENBQUNBLElBQUlBLE9BQU9BLENBQUNBLFVBQUNBLE9BQU9BLEVBQUVBLE1BQU1BO1lBQ2xDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUNYQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxRQUFRQSxFQUNwQkEsS0FBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FDMUJBO2lCQUNBQSxJQUFJQSxFQUFFQTtpQkFDTkEsU0FBU0EsQ0FBQ0EsVUFBQUEsR0FBR0E7Z0JBQ1pBLEVBQUVBLENBQUFBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLElBQUlBLEdBQUdBLENBQUNBLENBQUFBLENBQUNBO29CQUNyQkEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsVUFBVUEsR0FBR0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ3BDQSxDQUFDQTtnQkFDREEsSUFBSUEsSUFBSUEsR0FBR0EsR0FBR0EsQ0FBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0E7Z0JBQ3RCQSxNQUFNQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUN2QkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDTEEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDSkEsQ0FBQ0E7SUFLREoscUJBQUlBLEdBQUpBLFVBQUtBLFFBQWlCQSxFQUFFQSxJQUFrQkEsRUFBRUEsT0FBb0JBO1FBQWhFSyxpQkFpQkNBO1FBakJ1QkEsb0JBQWtCQSxHQUFsQkEsU0FBa0JBO1FBQUVBLHVCQUFvQkEsR0FBcEJBLFlBQW9CQTtRQUMvREEsSUFBSUEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDaEJBLE1BQU1BLENBQUNBLElBQUlBLE9BQU9BLENBQUNBLFVBQUNBLE9BQU9BLEVBQUVBLE1BQU1BO1lBQ2xDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUNaQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxRQUFRQSxFQUNwQkEsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFDcEJBLEtBQUlBLENBQUNBLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBLENBQzFCQTtpQkFDQUEsSUFBSUEsRUFBRUE7aUJBQ05BLFNBQVNBLENBQUNBLFVBQUFBLEdBQUdBO2dCQUNaQSxFQUFFQSxDQUFBQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFBQSxDQUFDQTtvQkFDckJBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLFVBQVVBLEdBQUdBLE1BQU1BLENBQUNBLENBQUNBO2dCQUNwQ0EsQ0FBQ0E7Z0JBQ0RBLElBQUlBLElBQUlBLEdBQUdBLEdBQUdBLENBQUNBLElBQUlBLEVBQUVBLENBQUNBO2dCQUN0QkEsTUFBTUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDdkJBLENBQUNBLENBQUNBLENBQUNBO1FBQ0xBLENBQUNBLENBQUNBLENBQUNBO0lBQ0pBLENBQUNBO0lBS0RMLG9CQUFHQSxHQUFIQSxVQUFJQSxRQUFpQkEsRUFBRUEsSUFBa0JBLEVBQUVBLE9BQW9CQTtRQUEvRE0saUJBaUJDQTtRQWpCc0JBLG9CQUFrQkEsR0FBbEJBLFNBQWtCQTtRQUFFQSx1QkFBb0JBLEdBQXBCQSxZQUFvQkE7UUFDOURBLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBO1FBQ2hCQSxNQUFNQSxDQUFDQSxJQUFJQSxPQUFPQSxDQUFDQSxVQUFDQSxPQUFPQSxFQUFFQSxNQUFNQTtZQUNsQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FDWEEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsUUFBUUEsRUFDcEJBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLENBQUNBLEVBQ3BCQSxLQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUMxQkE7aUJBQ0FBLElBQUlBLEVBQUVBO2lCQUNOQSxTQUFTQSxDQUFDQSxVQUFBQSxHQUFHQTtnQkFDWkEsRUFBRUEsQ0FBQUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7b0JBQ3JCQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxHQUFHQSxNQUFNQSxDQUFDQSxDQUFDQTtnQkFDcENBLENBQUNBO2dCQUNEQSxJQUFJQSxJQUFJQSxHQUFHQSxHQUFHQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtnQkFDdEJBLE1BQU1BLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ3ZCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNMQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNKQSxDQUFDQTtJQUtETix1QkFBTUEsR0FBTkEsVUFBT0EsUUFBaUJBLEVBQUVBLElBQWtCQSxFQUFFQSxPQUFvQkE7UUFBbEVPLGlCQWdCQ0E7UUFoQnlCQSxvQkFBa0JBLEdBQWxCQSxTQUFrQkE7UUFBRUEsdUJBQW9CQSxHQUFwQkEsWUFBb0JBO1FBQ2pFQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUNoQkEsTUFBTUEsQ0FBQ0EsSUFBSUEsT0FBT0EsQ0FBQ0EsVUFBQ0EsT0FBT0EsRUFBRUEsTUFBTUE7WUFDbENBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQ2RBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLFFBQVFBLEVBQ3BCQSxLQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUMxQkE7aUJBQ0FBLElBQUlBLEVBQUVBO2lCQUNOQSxTQUFTQSxDQUFDQSxVQUFBQSxHQUFHQTtnQkFDWkEsRUFBRUEsQ0FBQUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7b0JBQ3JCQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxHQUFHQSxNQUFNQSxDQUFDQSxDQUFDQTtnQkFDcENBLENBQUNBO2dCQUNEQSxJQUFJQSxJQUFJQSxHQUFHQSxHQUFHQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtnQkFDdEJBLE1BQU1BLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ3ZCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNMQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNKQSxDQUFDQTtJQTdHRlA7UUFHYUEsV0FBQ0EsaUJBQU1BLENBQUNBLGVBQUlBLENBQUNBLENBQUFBOztlQTJHekJBO0lBQURBLGFBQUNBO0FBQURBLENBOUdBLEFBOEdDQSxJQUFBO0FBOUdZLGNBQU0sU0E4R2xCLENBQUEiLCJmaWxlIjoic3JjL3NlcnZpY2VzL2FwaS9jbGllbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdCwgSW5qZWN0b3IsIGJpbmQsIEh0dHAsIEhlYWRlcnN9IGZyb20gJ2FuZ3VsYXIyL2FuZ3VsYXIyJztcbmltcG9ydCB7Q29va2llfSBmcm9tICdzcmMvc2VydmljZXMvY29va2llJztcblxuLyoqXG4gKiBBUEkgQ2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIENsaWVudCB7XG5cdGJhc2UgOiBzdHJpbmcgPSBcIi9cIjtcblx0Y29va2llIDogQ29va2llID0gbmV3IENvb2tpZSgpO1xuXHRjb25zdHJ1Y3RvcihASW5qZWN0KEh0dHApIHB1YmxpYyBodHRwIDogSHR0cCl7IH1cblxuXHRwcml2YXRlIGJ1aWxkUGFyYW1zKG9iamVjdCA6IE9iamVjdCl7XG5cdFx0cmV0dXJuIE9iamVjdC5rZXlzKG9iamVjdCkubWFwKChrKSA9PiB7XG5cdFx0XHRyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGspICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQob2JqZWN0W2tdKTtcblx0XHR9KS5qb2luKCcmJyk7XG5cdH1cblxuXHQvKipcblx0ICogQnVpbGQgdGhlIG9wdGlvbnNcblx0ICovXG5cdHByaXZhdGUgYnVpbGRPcHRpb25zKG9wdGlvbnMgOiBPYmplY3Qpe1xuXHRcdHZhciBYU1JGX1RPS0VOID0gdGhpcy5jb29raWUuZ2V0KCdYU1JGLVRPS0VOJyk7XG5cdFx0dmFyIGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuXHRcdGhlYWRlcnMuYXBwZW5kKCdYLVhTUkYtVE9LRU4nLCBYU1JGX1RPS0VOKTtcblx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbihvcHRpb25zLCB7XG5cdFx0XHRcdFx0aGVhZGVyczogaGVhZGVycyxcblx0XHRcdFx0XHRjYWNoZTogdHJ1ZVxuXHRcdFx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm4gYSBHRVQgcmVxdWVzdFxuXHQgKi9cblx0Z2V0KGVuZHBvaW50IDogc3RyaW5nLCBkYXRhIDogT2JqZWN0ID0ge30sIG9wdGlvbnM6IE9iamVjdCA9IHt9KXtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0ZW5kcG9pbnQgKz0gXCI/XCIgKyB0aGlzLmJ1aWxkUGFyYW1zKGRhdGEpO1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRzZWxmLmh0dHAuZ2V0KFxuXHRcdFx0XHRcdHNlbGYuYmFzZSArIGVuZHBvaW50LFxuXHRcdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKG9wdGlvbnMpXG5cdFx0XHRcdClcblx0XHRcdFx0LnRvUngoKVxuXHRcdFx0XHQuc3Vic2NyaWJlKHJlcyA9PiB7XG5cdFx0XHRcdFx0XHRpZihyZXMuc3RhdHVzICE9IDIwMCl7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoXCJIZWFkZXI6IFwiICsgc3RhdHVzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gcmVzLmpzb24oKTtcblx0XHRcdFx0XHRcdHJldHVybiByZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm4gYSBQT1NUIHJlcXVlc3Rcblx0ICovXG5cdHBvc3QoZW5kcG9pbnQgOiBzdHJpbmcsIGRhdGEgOiBPYmplY3QgPSB7fSwgb3B0aW9uczogT2JqZWN0ID0ge30pe1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c2VsZi5odHRwLnBvc3QoXG5cdFx0XHRcdFx0c2VsZi5iYXNlICsgZW5kcG9pbnQsXG5cdFx0XHRcdFx0SlNPTi5zdHJpbmdpZnkoZGF0YSksXG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMob3B0aW9ucylcblx0XHRcdFx0KVxuXHRcdFx0XHQudG9SeCgpXG5cdFx0XHRcdC5zdWJzY3JpYmUocmVzID0+IHtcblx0XHRcdFx0XHRcdGlmKHJlcy5zdGF0dXMgIT0gMjAwKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlamVjdChcIkhlYWRlcjogXCIgKyBzdGF0dXMpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIGRhdGEgPSByZXMuanNvbigpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc29sdmUoZGF0YSk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJldHVybiBhIFBVVCByZXF1ZXN0XG5cdCAqL1xuXHRwdXQoZW5kcG9pbnQgOiBzdHJpbmcsIGRhdGEgOiBPYmplY3QgPSB7fSwgb3B0aW9uczogT2JqZWN0ID0ge30pe1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c2VsZi5odHRwLnB1dChcblx0XHRcdFx0XHRzZWxmLmJhc2UgKyBlbmRwb2ludCxcblx0XHRcdFx0XHRKU09OLnN0cmluZ2lmeShkYXRhKSxcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhvcHRpb25zKVxuXHRcdFx0XHQpXG5cdFx0XHRcdC50b1J4KClcblx0XHRcdFx0LnN1YnNjcmliZShyZXMgPT4ge1xuXHRcdFx0XHRcdFx0aWYocmVzLnN0YXR1cyAhPSAyMDApe1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KFwiSGVhZGVyOiBcIiArIHN0YXR1cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgZGF0YSA9IHJlcy5qc29uKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShkYXRhKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogUmV0dXJuIGEgREVMRVRFIHJlcXVlc3Rcblx0ICovXG5cdGRlbGV0ZShlbmRwb2ludCA6IHN0cmluZywgZGF0YSA6IE9iamVjdCA9IHt9LCBvcHRpb25zOiBPYmplY3QgPSB7fSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRzZWxmLmh0dHAuZGVsZXRlKFxuXHRcdFx0XHRcdHNlbGYuYmFzZSArIGVuZHBvaW50LFxuXHRcdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKG9wdGlvbnMpXG5cdFx0XHRcdClcblx0XHRcdFx0LnRvUngoKVxuXHRcdFx0XHQuc3Vic2NyaWJlKHJlcyA9PiB7XG5cdFx0XHRcdFx0XHRpZihyZXMuc3RhdHVzICE9IDIwMCl7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoXCJIZWFkZXI6IFwiICsgc3RhdHVzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gcmVzLmpzb24oKTtcblx0XHRcdFx0XHRcdHJldHVybiByZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblx0fVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9