<div class="mdl-grid newsfeed-grid" style="max-width:900px">

  <!-- START: SEARCH BAR -->
  <div class="mdl-cell mdl-cell--4-col">

    <div class="mdl-textfield mdl-js-textfield minds-gatherings-search" [mdl]>
      <input class="mdl-textfield__input" type="text" id="gathering-search" (keyup)="doneTyping($event)" />
      <label class="mdl-textfield__label" for="gathering-search"><i class="material-icons">search</i> Search users...</label>
    </div>

    <!-- START: Users -->
    <div class="minds-gatherings-conversation-list">
        <div class="mdl-card minds-block" *ngFor="#user of conversations" [ngClass]="{'mdl-color--blue-grey-600': user.guid == conversation}">
          <div class="minds-avatar">
            <a [routerLink]="['/Messenger-Conversation', {guid: user.guid}]" >
              <img src="{{minds.cdn_url}}/icon/{{user.guid}}/small" class="mdl-shadow--2dp" alt={{user.username}} title={{user.username}}>
            </a>
          </div>
          <div class="minds-body">
            <a [routerLink]="['/Messenger-Conversation', {guid: user.guid}]"

              [ngClass]="{'mdl-color-text--blue-grey-100': user.guid == conversation, 'mdl-color-text--blue-grey-500': user.guid != conversation, 'not-subscribed': !user.subscribed}"
              >
              <h3>{{user.username}}</h3>
              <span *ngIf="user.last_msg" class="mdl-color-text--grey-500">{{user.last_msg * 1000 | date:'shortTime'}} - {{user.last_msg * 1000 | date:'longDate'}}</span>
              <unread [hidden]="!user.unread"></unread>
            </a>
            <minds-button-subscribe [user]="user" [hidden]="user.subscribed"></minds-button-subscribe>
          </div>
        </div>

      <infinite-scroll
        distance="25%"
        (load)="load()"
        [moreData]="hasMoreData"
        [inProgress]="inProgress"
        hideManual="true">
      </infinite-scroll>

    </div>
    <!-- END: Users -->

    <div class="gathering-footer-links">
      <a class="mdl-color-text--blue-grey-300" (click)="logout()" [hidden]="!setup">Logout of messenger</a>
    </div>
  </div>
  <!-- END: SEARCH BAR -->

  <div class="mdl-cell mdl-cell--8-col" >
    <minds-messenger-setup *ngIf="!setup" (done)="setup = true"></minds-messenger-setup>
    <minds-messenger-conversation *ngIf="setup" [conversation]="conversation"></minds-messenger-conversation>
  </div>
</div>
